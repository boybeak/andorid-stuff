## 解释AOT（Ahead-Of-Time）和JIT（Just-In-Time）编译的区别，ART的优势是什么？

在软件运行时，代码的编译主要有两种方式：**AOT（Ahead-Of-Time）编译**和**JIT（Just-In-Time）编译**。下面详细解释它们的区别以及ART（Android Runtime）的优势。

---

### AOT 编译（提前编译）

- **编译时机**：  
  在程序运行之前（通常是在应用安装或首次启动时），将字节码（如Java字节码）预先编译成目标平台的机器码。

- **优点**：  
  - **启动速度快**：应用启动时可以直接执行已经编译好的机器码，不需要等待编译过程。  
  - **运行效率高**：由于代码已转为本地机器码，减少了运行时的编译开销，从而能获得更稳定的执行性能。

- **缺点**：  
  - **安装时间长**：在安装或首次启动时，需要花费额外的时间进行编译。  
  - **存储空间占用增加**：预编译后的机器码可能比原始字节码大，增加了存储空间的消耗。  
  - **缺乏动态优化**：由于编译发生在运行前，无法根据实际运行情况进行针对性优化。

---

### JIT 编译（即时编译）

- **编译时机**：  
  在程序运行过程中，根据代码的执行情况动态地将部分字节码编译成机器码，通常在代码首次执行或者达到一定“热点”时进行编译。

- **优点**：  
  - **动态优化**：可以利用运行时收集的实际数据，针对热点代码进行更有针对性的优化，提升部分代码路径的性能。  
  - **减少初始编译工作量**：只有实际执行的代码才会被编译，可以避免不必要的编译工作，从而节省安装时间和存储空间。

- **缺点**：  
  - **启动和初次执行延迟**：由于编译在运行时进行，初次执行时可能会出现短暂的卡顿或延迟。  
  - **额外运行时开销**：运行时的编译过程会占用一定的CPU资源，可能对性能产生一定影响。

---

### ART（Android Runtime）的优势

ART是Android平台上的运行环境，自Android 5.0开始取代了Dalvik虚拟机。它的设计综合了AOT和JIT的优点，同时做了很多针对移动设备优化的改进：

1. **更快的启动速度和整体性能**：  
   - ART主要采用AOT编译，在应用安装时就将大部分字节码预编译成机器码，因此应用在启动时不需要额外的编译过程，能够更快地启动和响应。
   
2. **高效的垃圾回收和内存管理**：  
   - ART引入了改进的垃圾回收机制，减少了内存回收时的停顿，提供了更流畅的用户体验，尤其在内存较紧张的移动设备上表现更佳。

3. **节省运行时资源**：  
   - 由于在安装阶段就完成了大部分编译工作，应用运行时的CPU占用和电池消耗都得到了有效降低，有助于延长设备续航和提高系统响应速度。

4. **灵活的运行时优化**：  
   - 在后续的版本中，ART也引入了一些JIT技术或基于执行数据的再优化（profile-guided optimizations），使得即使对于动态变化的使用场景，也能对热点代码进行进一步优化，提升长期运行时的性能表现。

---

### 总结

- **AOT编译**：在应用运行前预先将代码编译为机器码，能够提供更快的启动速度和稳定的运行性能，但可能导致安装时间增加和存储空间消耗更大，同时缺少运行时的动态优化能力。
- **JIT编译**：在应用运行时按需编译代码，能利用实时数据对热点代码进行优化，从而提高执行效率，但会在初次执行时带来一定延迟和运行时开销。
- **ART的优势**：ART通过在安装时采用AOT编译，结合改进的垃圾回收和内存管理，以及适度引入JIT优化技术，实现了应用快速启动、高效运行和低能耗的目标，显著提升了Android系统的整体性能和用户体验。

这种综合策略使得ART成为适应现代移动设备需求的理想运行环境，既保证了即时响应，又能在长期使用中保持高效表现。



## 什么是ClassLoader的双亲委派模型？如何实现热修复？